@page "/account"
@using BankApp.Shared.Entities
@using static BankApp.Client.Shared.MainLayout

@inject AppStateContainer appState

<h3>Kontoinformation</h3>

<DetailedAccountInformationHeader BankAccount="bankAccount" FromDate="fromDate" ToDate="toDate" SetFromDate="SetFromDate" SetToDate="SetToDate" />
<DetailedAccountInformationBody FromDate="fromDate" ToDate="toDate" Categories="categories" Transactions="transactions" />

@code{

    [CascadingParameter] public MainLayout main { get; set; }

    private BankAccount bankAccount;

    DateTime fromDate = DateTime.Today.AddMonths(-1);
    DateTime toDate = DateTime.Today;

    public List<Category> categories = new List<Category>() // ska laddas in från databas
{
        new Category() { Name = "Mat", Color = "red" },
        new Category() { Name = "Kläder", Color = "pink" },
        new Category() { Name = "Transport", Color = "brown" },
        new Category() { Name = "Bostad", Color = "blue" },
        new Category() { Name = "Uteliv", Color = "yellow" },
        new Category() { Name = "Fritidsaktivitet", Color = "green" },
    };
    public List<Transaction> transactions = new List<Transaction>()

{
            new Transaction(new DateTime(2020, 11, 11), "ICA Sannegården", new Category{ Name = "Mat", Color = "red"}, 369.726m),
            new Transaction(new DateTime(2020, 11, 11), "ICA Sannegården", new Category{ Name = "Kläder", Color = "pink"}, 369.726m),
            new Transaction(new DateTime(2020, 11, 11), "ICA Sannegården", new Category { Name = "Mat", Color = "red" }, 369.726m),
            new Transaction(new DateTime(2020, 11, 11), "ICA Sannegården", new Category { Name = "Mat", Color = "red" }, 369.726m),
            new Transaction(new DateTime(2020, 11, 11), "ICA Sannegården", new Category { Name = "Mat", Color = "red" }, 369.726m),
            new Transaction(new DateTime(2020, 11, 11), "ICA Maxi Partille", new Category { Name = "Mat", Color = "red" }, 369.726m),
            new Transaction(new DateTime(2020, 11, 11), "ICA Sannegården", new Category { Name = "Mat", Color = "red" }, 369.726m),
            new Transaction(new DateTime(2020, 11, 11), "ICA Sannegården", new Category { Name = "Mat", Color = "red" }, 369.726m)

        };

    protected override void OnInitialized()
    {
        var list = main.BankAccount.Categories;
        bankAccount = new BankAccount() { Id = "0123456789" };
    }

    public void SetFromDate(ChangeEventArgs e) // consider refactoring, kan plockas ut för att använda till transactions också
    {
        var year = int.Parse(e.Value.ToString().Substring(0, 4));
        var month = int.Parse(e.Value.ToString().Substring(5, 2));
        var day = int.Parse(e.Value.ToString().Substring(8, 2));

        fromDate = new DateTime(year, month, day);
        Console.WriteLine(fromDate);
    }

    public void SetToDate(ChangeEventArgs e)
    {
        var year = int.Parse(e.Value.ToString().Substring(0, 4));
        var month = int.Parse(e.Value.ToString().Substring(5, 2));
        var day = int.Parse(e.Value.ToString().Substring(8, 2));

        toDate = new DateTime(year, month, day);
        Console.WriteLine(toDate);
    }
}




