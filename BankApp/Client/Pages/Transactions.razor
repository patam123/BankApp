@page "/transactions"

@using BankApp.Shared.Entities;
<h3>Transaktioner</h3>
<TransactionHeader />

@if (transactions == null)
{
    <p><em>Loading...</em></p>
}

else
{
    <table class="table">
        <thead>
            <tr>
                <th>Transaktionsdatum</th>
                <th>Transaktionsnamn</th>
                <th>Kategori</th>
                <th>Summa</th>
            </tr>
        </thead>
        <tbody>
            @for (int i = index * pageSize; i < (transactions.Count > ((index + 1) * pageSize) ? ((index + 1) * pageSize) : transactions.Count); i++)
            {
                <IndividualTransaction Transaction="transactions[i]" Categories="categories" />
            }
        </tbody>
    </table>

    <nav aria-label="Page navigation example">
        <ul class="pagination">
            <li class="page-item"><div class="page-link" @onclick="(() => SetIndex(index - 1))">Previous</div></li>
            @for (int i = 0; i < (transactions.Count / pageSize) + 1; i++)
            {
                var n = i;
                <li class="page-item"><div class="page-link" @onclick="(() => SetIndex(n))">@(i + 1) </div></li>

            }
            <li class="page-item"><div class="page-link" @onclick="(() => SetIndex(index + 1))">Next</div></li>
        </ul>
    </nav>
}

@code {
    int index = 0;
    int pageSize = 5;
    public List<Transaction> transactions;
    public List<Category> categories = new List<Category>()
{
        new Category() { Name = "Mat", Color = "red" },
        new Category() { Name = "Kläder", Color = "pink" },
        new Category() { Name = "Transport", Color = "brown" },
        new Category() { Name = "Bostad", Color = "blue" },
        new Category() { Name = "Uteliv", Color = "yellow" },
        new Category() { Name = "Fritidsaktivitet", Color = "green" },
    };

    protected override void OnInitialized()
    {
        transactions = new List<Transaction>()

{
            new Transaction(new DateTime(2020, 11, 11), "ICA Sannegården", new Category{ Name = "Mat", Color = "red"}, 369.726m),
            new Transaction(new DateTime(2020, 11, 11), "ICA Sannegården", new Category{ Name = "Kläder", Color = "pink"}, 369.726m),
            new Transaction(new DateTime(2020, 11, 11), "ICA Sannegården", new Category{ Name = "Mat", Color = "red"}, 369.726m),
            new Transaction(new DateTime(2020, 11, 11), "ICA Sannegården", new Category{ Name = "Mat", Color = "red"}, 369.726m),
            new Transaction(new DateTime(2020, 11, 11), "ICA Sannegården", new Category{ Name = "Mat", Color = "red"}, 369.726m),
            new Transaction(new DateTime(2020, 11, 11), "ICA Maxi Partille", new Category{ Name = "Mat", Color = "red"}, 369.726m),
            new Transaction(new DateTime(2020, 11, 11), "ICA Sannegården", new Category{ Name = "Mat", Color = "red"}, 369.726m),
            new Transaction(new DateTime(2020, 11, 11), "ICA Sannegården", new Category{ Name = "Mat", Color = "red"}, 369.726m)

        };
    }

    public void SetIndex(int i)
    {
        if (i >= 0 && i <= (transactions.Count / pageSize))
        {

            Console.WriteLine(i);
            index = i;
            Console.WriteLine(index);
        }
    }

}
